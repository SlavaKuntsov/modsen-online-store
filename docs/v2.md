# 2. API для интернет-магазина (упрощенный аналог)

## Содержание

- [Функционал](#Функционал)
- [Примеры хранимых сущностей](#Примеры-хранимых-сущностей)
- [Используемые технологии](#Используемые-технологии)
- [Полезные ссылки](#Полезные-ссылки)

## Функционал:

### 1. Аутентификация и авторизация
1. [x] Регистрация пользователя (email/пароль)
   - [x] Валидация
2. [x] Вход в систему (JWT токен)
3. [x] Восстановление пароля
4. [x] Роли: `Admin`, `Customer`, `Guest`
5. [x] Управление профилем пользователя

### 2. Управление товарами
- [x] **CRUD операции** для товаров
- [x] Управление категориями товаров (древовидная структура)
- [x] Фильтрация товаров по:
  - Категории
  - Цене (диапазон)
  - Рейтингу
  - Наличию на складе
- [x] Сортировка (по цене, популярности, новизне)

### 3. Корзина покупок
- [x] Добавление/удаление товаров
- [x] Изменение количества товаров
- [x] Промежуточный расчет стоимости
- [x] Временное хранение корзины (для авторизованных и гостей)

### 4. Оформление заказов
- Создание заказа из корзины
- Выбор способа доставки
- Валидация данных заказа
- Подтверждение заказа (email уведомление)

### 5. История заказов
- [x] Просмотр списка заказов пользователя
- [x] Детализация конкретного заказа
- [x] Статусы заказов (`Создан`, `Оплачен`, `В доставке`, `Завершен`)

### 6. Дополнительные функции
- Применение промокодов
- Система рейтингов/отзывов
- Избранные товары
- Поиск по названию/описанию

## Примеры хранимых сущностей

```csharp
// Пользователь
public class User 
{
    public Guid Id { get; set; }
    public string Email { get; set; }
    public string PasswordHash { get; set; }
    public string Role { get; set; }
    public DateTime CreatedAt { get; set; }
    public List<Order> Orders { get; set; }
}

// Товар
public class Product
{
    public Guid Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public decimal Price { get; set; }
    public int StockQuantity { get; set; }
    public Guid CategoryId { get; set; }
    public Category Category { get; set; }
    public List<ProductImage> Images { get; set; }
}

// Категория
public class Category 
{
    public Guid Id { get; set; }
    public string Name { get; set; }
    public Guid? ParentCategoryId { get; set; }
    public Category ParentCategory { get; set; }
    public List<Product> Products { get; set; }
}

// Корзина
public class Cart
{
    public Guid Id { get; set; }
    public Guid? UserId { get; set; }
    public User User { get; set; }
    public List<CartItem> Items { get; set; }
}

// Элемент заказа
public class OrderItem
{
    public Guid Id { get; set; }
    public Guid OrderId { get; set; }
    public Order Order { get; set; }
    public Guid ProductId { get; set; }
    public Product Product { get; set; }
    public int Quantity { get; set; }
    public decimal UnitPrice { get; set; }
}

// Промокод
public class PromoCode
{
    public Guid Id { get; set; }
    public string Code { get; set; }
    public decimal DiscountValue { get; set; }
    public DateTime ExpiryDate { get; set; }
    public bool IsActive { get; set; }
}
```

## Используемые технологии

- ASP.NET Core 
- Entity Framework Core
- RESTful-архитектура
- Документация (Swagger)
- Юнит-тесты (xUnit)
- GitFlow 

## Полезные ссылки

- [ASP.NET Core](https://metanit.com/sharp/aspnet5/1.1.php)
- [Entity Framework Core](https://metanit.com/sharp/efcore/)
- [xUnit](https://xunit.net/#documentation)
- [Moq](https://metanit.com/sharp/aspnet5/22.4.php)
- [GitFlow](https://docs.github.com/en/get-started/using-github/github-flow)
- [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/)